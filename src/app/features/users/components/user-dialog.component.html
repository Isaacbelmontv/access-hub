<p-dialog
  [header]="
    !user
      ? ('USER_DIALOG.HEADER.CREATE' | translate)
      : editable
      ? ('USER_DIALOG.HEADER.EDIT' | translate)
      : ('USER_DIALOG.HEADER.DETAIL' | translate)
  "
  [(visible)]="visible"
  [modal]="true"
  [style]="{ width: '45rem' }"
  [closable]="true"
  [dismissableMask]="true"
  (onHide)="onClose()"
>
  <div class="mb-3 text-500">
    @if (!user) {
    {{ 'USER_DIALOG.DESCRIPTION.CREATE' | translate }}
    } @else {
    {{
      editable
        ? ('USER_DIALOG.DESCRIPTION.EDIT' | translate)
        : ('USER_DIALOG.DESCRIPTION.DETAIL' | translate)
    }}
    }
  </div>

  <form [formGroup]="form" class="p-fluid">
    <div class="formgrid grid mt-6">
      <div class="field col-12 md:col-6 md:mt-3">
        <p-floatLabel>
          <p-iconField>
            <p-inputIcon class="pi pi-user" />
            <input
              pInputText
              id="name"
              type="text"
              formControlName="name"
              class="w-full"
              [readonly]="!editable"
            />
          </p-iconField>
          <label for="name">{{ 'USER_DIALOG.FIELDS.NAME' | translate }}</label>
        </p-floatLabel>
        @if(form.get('name')?.touched && form.get('name')?.invalid){
        <small class="p-error">{{ 'USER_DIALOG.ERRORS.NAME_REQUIRED' | translate }}</small>
        }
      </div>

      <div class="field col-12 md:col-6 mt-3">
        <p-floatLabel>
          <p-iconField>
            <p-inputIcon class="pi pi-envelope" />
            <input
              pInputText
              id="email"
              type="email"
              formControlName="email"
              class="w-full"
              [readonly]="!editable"
            />
          </p-iconField>
          <label for="email">{{ 'USER_DIALOG.FIELDS.EMAIL' | translate }}</label>
        </p-floatLabel>
        @if(form.get('email')?.touched && form.get('email')?.hasError('required')){
        <small class="p-error">{{ 'USER_DIALOG.ERRORS.EMAIL_REQUIRED' | translate }}</small>
        }
      </div>

      <div class="field col-12 md:col-6 mt-3">
        <p-floatLabel>
          <p-iconField>
            <p-inputIcon class="pi pi-phone" />
            <input
              pInputText
              id="phone"
              type="text"
              formControlName="phone"
              class="w-full"
              maxlength="21"
              [readonly]="!editable"
            />
          </p-iconField>
          <label for="phone">{{ 'USER_DIALOG.FIELDS.PHONE' | translate }}</label>
        </p-floatLabel>
        @if(form.get('phone')?.touched && form.get('phone')?.hasError('required')){
        <small class="p-error">{{ 'USER_DIALOG.ERRORS.PHONE_REQUIRED' | translate }}</small>
        }
      </div>

      <div class="field col-12 md:col-6 mt-3">
        <p-floatLabel>
          <p-iconField>
            <p-inputIcon class="pi pi-globe" />
            <input
              pInputText
              id="website"
              type="text"
              formControlName="website"
              class="w-full"
              [readonly]="!editable"
            />
          </p-iconField>
          <label for="website">{{ 'USER_DIALOG.FIELDS.WEBSITE' | translate }}</label>
        </p-floatLabel>
        @if(form.get('website')?.touched && form.get('website')?.hasError('required')){
        <small class="p-error">{{ 'USER_DIALOG.ERRORS.REQUIRED' | translate }}</small>
        }
      </div>
    </div>

    <p-fieldset
      legend="{{ 'USER_DIALOG.FIELDS.COMPANY' | translate }}"
      formGroupName="company"
      class="mt-3"
    >
      <div class="formgrid grid">
        <div class="field col-12 md:col-6 mt-3">
          <p-floatLabel>
            <p-iconField>
              <p-inputIcon class="pi pi-briefcase" />
              <input
                pInputText
                id="companyName"
                formControlName="name"
                class="w-full"
                [readonly]="!editable"
              />
            </p-iconField>
            <label for="companyName">{{ 'USER_DIALOG.FIELDS.COMPANY_NAME' | translate }}</label>
          </p-floatLabel>
          @if(form.get('company.name')?.touched && form.get('company.name')?.hasError('required')){
          <small class="p-error">{{ 'USER_DIALOG.ERRORS.REQUIRED' | translate }}</small>
          }
        </div>

        <div class="field col-12 md:col-6 my-3">
          <p-floatLabel>
            <p-iconField>
              <p-inputIcon class="pi pi-tags" />
              <input
                pInputText
                id="bs"
                formControlName="bs"
                class="w-full"
                [readonly]="!editable"
              />
            </p-iconField>
            <label for="bs">{{ 'USER_DIALOG.FIELDS.COMPANY_SECTOR' | translate }}</label>
          </p-floatLabel>
          @if(form.get('company.bs')?.touched && form.get('company.bs')?.hasError('required')){
          <small class="p-error">{{ 'USER_DIALOG.ERRORS.REQUIRED' | translate }}</small>
          }
        </div>

        <div class="field col-12 my-3">
          <p-floatLabel>
            <p-iconField>
              <p-inputIcon class="pi pi-comment" />
              <input
                pInputText
                id="catchPhrase"
                formControlName="catchPhrase"
                class="w-full"
                [readonly]="!editable"
              />
            </p-iconField>
            <label for="catchPhrase">{{ 'USER_DIALOG.FIELDS.COMPANY_SLOGAN' | translate }}</label>
          </p-floatLabel>
          @if(form.get('company.catchPhrase')?.touched &&
          form.get('company.catchPhrase')?.hasError('required')){
          <small class="p-error">{{ 'USER_DIALOG.ERRORS.REQUIRED' | translate }}</small>
          }
        </div>
      </div>
    </p-fieldset>

    <div class="mt-3">
      <p-fieldset legend="{{ 'USER_DIALOG.FIELDS.ADDRESS' | translate }}" formGroupName="address">
        <div class="formgrid grid">
          <div class="field col-12 my-3">
            <p-floatLabel>
              <p-iconField>
                <p-inputIcon class="pi pi-map-marker" />
                <input
                  pInputText
                  id="street"
                  formControlName="street"
                  class="w-full"
                  [readonly]="!editable"
                />
              </p-iconField>
              <label for="street">{{ 'USER_DIALOG.FIELDS.STREET' | translate }}</label>
            </p-floatLabel>
            @if(form.get('address.street')?.touched &&
            form.get('address.street')?.hasError('required')){
            <small class="p-error">{{ 'USER_DIALOG.ERRORS.REQUIRED' | translate }}</small>
            }
          </div>

          <div class="field col-12 md:col-6 mt-3">
            <p-floatLabel>
              <p-iconField>
                <p-inputIcon class="pi pi-building" />
                <input
                  pInputText
                  id="city"
                  formControlName="city"
                  class="w-full"
                  [readonly]="!editable"
                />
              </p-iconField>
              <label for="city">{{ 'USER_DIALOG.FIELDS.CITY' | translate }}</label>
            </p-floatLabel>
            @if(form.get('address.city')?.touched &&
            form.get('address.city')?.hasError('required')){
            <small class="p-error">{{ 'USER_DIALOG.ERRORS.REQUIRED' | translate }}</small>
            }
          </div>

          <div class="field col-12 md:col-6 my-3">
            <p-floatLabel>
              <p-iconField>
                <p-inputIcon class="pi pi-hashtag" />
                <input
                  pInputText
                  id="zipcode"
                  formControlName="zipcode"
                  class="w-full"
                  [readonly]="!editable"
                />
              </p-iconField>
              <label for="zipcode">{{ 'USER_DIALOG.FIELDS.ZIPCODE' | translate }}</label>
            </p-floatLabel>
            @if(form.get('address.zipcode')?.touched &&
            form.get('address.zipcode')?.hasError('required')){
            <small class="p-error">{{ 'USER_DIALOG.ERRORS.REQUIRED' | translate }}</small>
            }
          </div>
        </div>
      </p-fieldset>
    </div>

    <div class="flex justify-content-end gap-2 mt-4">
      <p-button
        [label]="
          editable
            ? ('USER_DIALOG.ACTIONS.CANCEL' | translate)
            : ('USER_DIALOG.ACTIONS.CLOSE' | translate)
        "
        (click)="onClose()"
        severity="secondary"
        outlined
        icon="pi pi-times"
        iconPos="left"
      ></p-button>

      @if(editable){
      <p-button
        [disabled]="form.invalid"
        [label]="'USER_DIALOG.ACTIONS.SAVE' | translate"
        (click)="onSave()"
        severity="primary"
        icon="pi pi-check"
        iconPos="left"
      ></p-button>
      }
    </div>
  </form>
</p-dialog>
